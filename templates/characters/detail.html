{{define "title"}}{{.Character.Name}} - Character Details - Mordezzan{{end}}
{{define "content"}}
<div>
    <h1>{{.Character.Name}}</h1>

    <!-- Character Actions -->
    <div>
        <a href="/characters/edit?id={{.Character.ID}}">Edit Character</a>
        <form action="/characters/delete" method="POST" style="display: inline">
            <input
                type="hidden"
                name="character_id"
                value="{{.Character.ID}}"
            />
            <button
                type="submit"
                onclick="return confirm('Are you sure you want to delete this character?')"
            >
                Delete Character
            </button>
        </form>
    </div>

    {{if .FlashMessage}}
    <div>{{.FlashMessage}}</div>
    {{end}}

    <!-- Basic Stats -->
    <div>
        <h2>Hit Points</h2>
        <div>{{.Character.CurrentHp}} / {{.Character.MaxHp}}</div>
    </div>

    <div class="character-xp">
        <h2>Experience</h2>
        <div class="xp-details">
            <div>Current XP: {{.Character.ExperiencePoints}}</div>
            <div>Next Level: {{.Character.NextLevelXP}}</div>
            <div>XP Needed: {{.Character.XPNeeded}}</div>
        </div>
    </div>

    <!-- Ability Scores -->
    <div>
        <h2>Ability Scores</h2>
        <div>
            <h3>Strength: {{.Character.Strength}}</h3>
            <ul>
                <li>
                    Attack (Melee): {{if ge
                    .Character.StrengthModifiers.AttackMod
                    0}}+{{end}}{{.Character.StrengthModifiers.AttackMod}}
                </li>
                <li>
                    Damage: {{if ge .Character.StrengthModifiers.DamageMod
                    0}}+{{end}}{{.Character.StrengthModifiers.DamageMod}}
                </li>
                <li>
                    Test of Strength:
                    {{.Character.StrengthModifiers.TestOfStrength}}
                </li>
                <li>
                    Extraordinary Feat:
                    {{.Character.StrengthModifiers.ExtraordinaryFeat}}%
                </li>
            </ul>

            <h3>Dexterity: {{.Character.Dexterity}}</h3>
            <ul>
                <li>
                    Attack (Missile): {{if ge
                    .Character.DexterityModifiers.AttackMod
                    0}}+{{end}}{{.Character.DexterityModifiers.AttackMod}}
                </li>
                <li>
                    Defense: {{if ge .Character.DexterityModifiers.DefenseAdj
                    0}}+{{end}}{{.Character.DexterityModifiers.DefenseAdj}}
                </li>
                <li>
                    Test of Dexterity:
                    {{.Character.DexterityModifiers.TestOfDexterity}}
                </li>
                <li>
                    Extraordinary Feat:
                    {{.Character.DexterityModifiers.ExtraordinaryFeat}}%
                </li>
            </ul>

            <h3>Constitution: {{.Character.Constitution}}</h3>
            <ul>
                <li>
                    Hit Points/Level: {{if ge
                    .Character.ConstitutionModifiers.HitPointMod
                    0}}+{{end}}{{.Character.ConstitutionModifiers.HitPointMod}}
                </li>
                <li>
                    Poison/Radiation: {{if ge
                    .Character.ConstitutionModifiers.PoisonRadMod
                    0}}+{{end}}{{.Character.ConstitutionModifiers.PoisonRadMod}}
                </li>
                <li>
                    Trauma Survival:
                    {{.Character.ConstitutionModifiers.TraumaSurvival}}%
                </li>
                <li>
                    Test of Constitution:
                    {{.Character.ConstitutionModifiers.TestOfCon}}
                </li>
                <li>
                    Extraordinary Feat:
                    {{.Character.ConstitutionModifiers.ExtraordinaryFeat}}%
                </li>
            </ul>

            <h3>Intelligence: {{.Character.Intelligence}}</h3>
            <ul>
                <li>
                    Languages: {{.Character.IntelligenceModifiers.Languages}}
                    additional
                </li>
                <li>
                    Bonus Spell Level:
                    {{.Character.IntelligenceModifiers.BonusSpellLevel}}
                </li>
                <li>
                    Chance to Learn:
                    {{.Character.IntelligenceModifiers.ChanceToLearn}}%
                </li>
                <li>
                    Literate: {{if
                    .Character.IntelligenceModifiers.IsLiterate}}Yes{{else}}No{{end}}
                </li>
            </ul>

            <h3>Wisdom: {{.Character.Wisdom}}</h3>
            <ul>
                <li>
                    Willpower Adjustment: {{if ge
                    .Character.WisdomModifiers.WillpowerAdj
                    0}}+{{end}}{{.Character.WisdomModifiers.WillpowerAdj}}
                </li>
                <li>
                    Bonus Spell Level:
                    {{.Character.WisdomModifiers.BonusSpellLevel}}
                </li>
                <li>
                    Spell Learning Chance:
                    {{.Character.WisdomModifiers.SpellLearningChance}}%
                </li>
            </ul>

            <h3>Charisma: {{.Character.Charisma}}</h3>
            <ul>
                <li>
                    Reaction/Loyalty Adjustment: {{if ge
                    .Character.CharismaModifiers.ReactionLoyaltyAdj
                    0}}+{{end}}{{.Character.CharismaModifiers.ReactionLoyaltyAdj}}
                </li>
                <li>
                    Maximum Henchmen:
                    {{.Character.CharismaModifiers.MaxHenchmen}}
                </li>
                <li>
                    Undead Turning Adjustment: {{if ge
                    .Character.CharismaModifiers.UndeadTurningAdj
                    0}}+{{end}}{{.Character.CharismaModifiers.UndeadTurningAdj}}
                </li>
            </ul>
        </div>
    </div>

    <!-- Saving Throws -->
    <div>
        <h2>Saving Throws</h2>
        <p>Base Target: {{.Character.SavingThrow}}+ on d20</p>

        <table class="saving-throws">
            <tr>
                <th>Type</th>
                <th>Modifier</th>
                <th>Final Target</th>
            </tr>
            <tr>
                <td>Death</td>
                <td>+0</td>
                <td>{{.Character.SavingThrow}}</td>
            </tr>
            <tr>
                <td>Transformation</td>
                <td>+0</td>
                <td>{{.Character.SavingThrow}}</td>
            </tr>
            <tr>
                <td>Device</td>
                <td>+0</td>
                <td>{{.Character.SavingThrow}}</td>
            </tr>
            <tr>
                <td>Avoidance</td>
                <td>+0</td>
                <td>{{.Character.SavingThrow}}</td>
            </tr>
            <tr>
                <td>Sorcery</td>
                <td>+0</td>
                <td>{{.Character.SavingThrow}}</td>
            </tr>
        </table>
    </div>

    <!-- Combat -->
    <div>
        <h2>Combat Matrix</h2>
        <table border="1">
            <tr>
                <th>AC</th>
                {{range $i := seq -9 9}}
                <th>{{$i}}</th>
                {{end}}
            </tr>
            <tr>
                <td>Target</td>
                {{range $tn := .Character.CombatMatrix}}
                <td>{{$tn}}</td>
                {{end}}
            </tr>
        </table>
    </div>

    <div>
        <h2>Equipped Weapons</h2>
        {{range .Character.EquippedItems}} {{if or (eq .ItemType "weapon") (eq
        .ItemType "ranged_weapon")}}
        <div class="weapon-entry">
            <h3>{{.ItemName}}</h3>
            {{if .Damage.Valid}}
            <p>Base Damage: {{.Damage.String}}</p>
            {{end}}
        </div>
        {{end}} {{end}}
    </div>
    <!-- Inventory Section -->
    <div>
        <div>
            <h2>Inventory</h2>
            <a href="/characters/inventory/add?character_id={{.Character.ID}}"
                >Add Item</a
            >
        </div>

        <!-- Encumbrance Information -->
        <div>
            <h3>Encumbrance Status</h3>
            <p>Total Weight: {{.Character.InventoryStats.TotalWeight}} lbs</p>
            <p>Status: {{.Character.InventoryStats.EncumbranceLevel}}</p>
            <p>
                Encumbered at: {{.Character.InventoryStats.BaseEncumbered}} lbs
            </p>
            <p>
                Heavily Encumbered at:
                {{.Character.InventoryStats.BaseHeavyEncumbered}} lbs
            </p>
            <p>
                Maximum Capacity: {{.Character.InventoryStats.MaximumCapacity}}
                lbs
            </p>
        </div>

        <!-- Equipped Items -->
        {{if .Character.EquippedItems}}
        <div>
            <h3>Equipped Items</h3>
            <table border="1">
                <thead>
                    <tr>
                        <th>Slot</th>
                        <th>Item</th>
                        <th>Weight</th>
                        <th>Quantity</th>
                        <th>Damage</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .Character.EquippedItems}}
                    <tr>
                        <td>{{.SlotName.String}}</td>
                        <td>{{.ItemName}}</td>
                        <td>{{.ItemWeight}} lbs</td>
                        <td>{{.Quantity}}</td>
                        <td>{{if .Damage.Valid}}{{.Damage.String}}{{end}}</td>
                        <td>{{if .Notes}}{{.Notes.String}}{{end}}</td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{end}}

        <!-- Carried Items -->
        {{if .Character.CarriedItems}}
        <div>
            <h3>Carried Items</h3>
            <table border="1">
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Weight</th>
                        <th>Quantity</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .Character.CarriedItems}}
                    <tr>
                        <td>{{.ItemName}}</td>
                        <td>{{.ItemWeight}} lbs</td>
                        <td>{{.Quantity}}</td>
                        <td>{{if .Notes}}{{.Notes.String}}{{end}}</td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{end}}

        <!-- Container Contents -->
        {{range $containerId, $items := .Character.ContainerItems}}
        <div>
            <h3>Container Contents</h3>
            <table border="1">
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Weight</th>
                        <th>Quantity</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    {{range $items}}
                    <tr>
                        <td>{{.ItemName}}</td>
                        <td>{{.ItemWeight}} lbs</td>
                        <td>{{.Quantity}}</td>
                        <td>{{if .Notes}}{{.Notes.String}}{{end}}</td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{end}}
    </div>
</div>
{{end}}
