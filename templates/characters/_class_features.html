{{define "class_features"}}
<div class="class-features-section">
    <h2>Class Abilities</h2>
    <div class="class-abilities">
        {{if eq .Character.Class "Fighter"}}
        <div class="ability-card">
            <h3 class="ability-header">
                Heroic Fighting
                <button class="toggle-ability" aria-label="Toggle ability details">
                    <span class="toggle-icon">▼</span>
                </button>
            </h3>
            <div class="ability-content">
                <p>To smite multiple foes. When combating opponents of 1 Hit Dice or less, double normal melee attacks
                    per round (2/1, or 3/1 if wielding a mastered weapon). This dramatic attack could be effected as a
                    single, devastating swing or lunge that burst through multiple foes.</p>
                <p>At 7th level, when combating foes of 2 HD or less, double normal melee attacks per round (3/1, or 4/1
                    if wielding a mastered weapon)</p>
            </div>
        </div>

        <div class="ability-card">
            <h3 class="ability-header">
                Weapon Mastery
                <button class="toggle-ability" aria-label="Toggle ability details">
                    <span class="toggle-icon">▼</span>
                </button>
            </h3>
            <div class="ability-content">
                <p>Master of two weapons (+1 "to hit" and +1 damage). Additional weapons may be mastered at 4th, 8th,
                    and 12th levels; however, see grand mastery below, for another option. The attack rate for melee
                    weapons and the rates of fire for most missile weapons improve through weapon mastery.</p>
            </div>
        </div>

        <div class="ability-card">
            <h3 class="ability-header">
                Grand Mastery
                <button class="toggle-ability" aria-label="Toggle ability details">
                    <span class="toggle-icon">▼</span>
                </button>
            </h3>
            <div class="ability-content">
                <p>At 4th, 8th, or 12th level (player's choice), when a new weapon mastery is gained, fighters may elect
                    to intensify their training with an already mastered weapon. With this weapon the fighter becomes a
                    grand master (+2 "to hit" and +2 damage, increased attack rate etc.) A fighter may achieve grand
                    mastery with but one weapon.</p>
            </div>
        </div>

        {{else if eq .Character.Class "Thief"}}
        <div class="ability-card">
            <h3 class="ability-header">
                Backstab
                <button class="toggle-ability" aria-label="Toggle ability details">
                    <span class="toggle-icon">▼</span>
                </button>
            </h3>
            <div class="ability-content">
                <p>When attacking unaware opponents from behind, you deal double damage. This multiplier increases to ×3
                    at 5th level and ×4 at 9th level.</p>
            </div>
        </div>

        <div class="ability-card">
            <h3 class="ability-header">
                Thief Skills
                <button class="toggle-ability" aria-label="Toggle ability details">
                    <span class="toggle-icon">▼</span>
                </button>
            </h3>
            <div class="ability-content">
                <p>You have special abilities that improve as you gain levels: Open Locks, Remove Traps, Pick Pockets,
                    Move Silently, Climb Walls, Hide in Shadows.</p>
            </div>
        </div>

        {{else if eq .Character.Class "Cleric"}}
        <div class="ability-card">
            <h3 class="ability-header">
                Turn Undead
                <button class="toggle-ability" aria-label="Toggle ability details">
                    <span class="toggle-icon">▼</span>
                </button>
            </h3>
            <div class="ability-content">
                <p>As an action, you can attempt to turn undead creatures within 60 feet. The effectiveness improves as
                    you gain levels.</p>
            </div>
        </div>

        <div class="ability-card">
            <h3 class="ability-header">
                Divine Magic
                <button class="toggle-ability" aria-label="Toggle ability details">
                    <span class="toggle-icon">▼</span>
                </button>
            </h3>
            <div class="ability-content">
                <p>You can cast divine spells. Your spell slots increase as you gain levels.</p>
            </div>
        </div>

        {{else if eq .Character.Class "Magician"}}
        <div class="ability-card">
            <h3 class="ability-header">
                Arcane Magic
                <button class="toggle-ability" aria-label="Toggle ability details">
                    <span class="toggle-icon">▼</span>
                </button>
            </h3>
            <div class="ability-content">
                <p>You can cast arcane spells. Your spell slots increase as you gain levels.</p>
            </div>
        </div>

        <div class="ability-card">
            <h3 class="ability-header">
                Arcane Research
                <button class="toggle-ability" aria-label="Toggle ability details">
                    <span class="toggle-icon">▼</span>
                </button>
            </h3>
            <div class="ability-content">
                <p>You can research new spells and create magic scrolls when you have the time and resources.</p>
            </div>
        </div>
        {{end}}
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Add click event listeners to all toggle buttons
        const toggleButtons = document.querySelectorAll('.toggle-ability');
        toggleButtons.forEach(button => {
            button.addEventListener('click', function (e) {
                e.preventDefault();

                // Find the parent card and content
                const card = this.closest('.ability-card');
                const content = card.querySelector('.ability-content');
                const icon = this.querySelector('.toggle-icon');

                // Toggle visibility
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                    icon.textContent = '▼';
                } else {
                    content.style.display = 'none';
                    icon.textContent = '▶';
                }
            });
        });
    });
</script>
{{end}}